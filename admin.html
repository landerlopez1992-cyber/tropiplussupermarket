<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administraci√≥n - Tropiplus Supermarket</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .admin-header {
            background: linear-gradient(135deg, var(--dark-blue-nav) 0%, var(--light-blue-header) 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .admin-header h1 {
            margin: 0;
            font-size: 32px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--gray-border);
        }
        .admin-tab {
            padding: 15px 30px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: var(--gray-text);
            transition: all 0.3s;
        }
        .admin-tab.active {
            color: var(--green-categories);
            border-bottom-color: var(--green-categories);
        }
        .admin-tab:hover {
            color: var(--green-categories);
        }
        .admin-content {
            display: none;
        }
        .admin-content.active {
            display: block;
        }
        .admin-internal-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--gray-border);
            padding-bottom: 10px;
        }
        .admin-internal-btn {
            padding: 12px 25px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
            color: var(--gray-text);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .admin-internal-btn.active {
            color: var(--green-categories);
            border-bottom-color: var(--green-categories);
        }
        .admin-internal-btn:hover {
            color: var(--green-categories);
        }
        .admin-subcontent {
            display: none;
        }
        .admin-subcontent.active {
            display: block;
        }
        .tv-admin-grid {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 20px;
        }
        .tv-panel-card {
            background: #fff;
            border-radius: 10px;
            padding: 18px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        .tv-list-item {
            border: 1px solid var(--gray-border);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
            background: #fafbff;
        }
        .tv-list-item h4 {
            margin: 0 0 6px 0;
            color: var(--dark-blue-nav);
        }
        .tv-meta {
            font-size: 13px;
            color: var(--gray-text);
            margin-bottom: 8px;
        }
        .tv-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .tv-actions button,
        .tv-actions a {
            padding: 8px 10px;
            border-radius: 6px;
            border: none;
            text-decoration: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }
        .tv-btn-open { background: #1a73e8; color: #fff; }
        .tv-btn-edit { background: var(--green-categories); color: #fff; }
        .tv-btn-delete { background: #d93025; color: #fff; }
        @media (max-width: 980px) {
            .tv-admin-grid { grid-template-columns: 1fr; }
        }
        .products-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .products-table th {
            background: var(--green-categories);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        .products-table td {
            padding: 15px;
            border-bottom: 1px solid var(--gray-border);
            vertical-align: middle;
        }
        .products-table td img {
            display: block;
            margin: 0 auto;
        }
        .products-table tr:hover {
            background: var(--gray-light);
        }
        .stock-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .stock-badge.low {
            background: #ffebee;
            color: #c62828;
        }
        .stock-badge.medium {
            background: #fff3e0;
            color: #e65100;
        }
        .stock-badge.high {
            background: #e8f5e9;
            color: #2e7d32;
        }
        .stock-badge.out {
            background: #fce4ec;
            color: #c2185b;
        }
        .btn-edit-supplier {
            background: var(--green-categories);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .btn-edit-supplier:hover {
            background: var(--green-categories-dark);
            transform: translateY(-2px);
        }
        .supplier-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .supplier-name {
            font-weight: 500;
            color: var(--dark-blue-nav);
        }
        .supplier-url {
            color: var(--green-categories);
            text-decoration: none;
            font-size: 12px;
        }
        .supplier-url:hover {
            text-decoration: underline;
        }
        .no-supplier {
            color: var(--gray-text);
            font-style: italic;
        }
        .supplier-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }
        .supplier-modal.active {
            display: flex;
        }
        .supplier-modal-content {
            background: white;
            padding: 25px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .supplier-form-group {
            margin-bottom: 15px;
        }
        .supplier-form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--black);
            font-size: 13px;
        }
        .supplier-form-group input,
        .supplier-form-group textarea,
        .supplier-form-group select {
            width: 100%;
            max-width: 100%;
            padding: 10px;
            border: 2px solid var(--gray-border);
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        .supplier-form-group textarea {
            resize: vertical;
            min-height: 60px;
        }
        .supplier-form-group input:focus,
        .supplier-form-group textarea:focus {
            outline: none;
            border-color: var(--green-categories);
        }
        .supplier-modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        .btn-cancel, .btn-save {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        .global-supplier-form-container {
            max-width: 600px;
            margin: 0 auto;
        }
        .global-suppliers-list-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .btn-cancel {
            background: var(--gray-light);
            color: var(--black);
        }
        .btn-cancel:hover {
            background: var(--gray-border);
        }
        .btn-save {
            background: var(--green-categories);
            color: white;
        }
        .btn-save:hover {
            background: var(--green-categories-dark);
        }
        .search-filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid var(--gray-border);
            border-radius: 6px;
            font-size: 14px;
        }
        .filter-select {
            padding: 12px;
            border: 2px solid var(--gray-border);
            border-radius: 6px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .stat-card-title {
            font-size: 14px;
            color: var(--gray-text);
            margin-bottom: 10px;
        }
        .stat-card-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--dark-blue-nav);
        }
    </style>
</head>
<body>
    <!-- Header Principal con Logo y B√∫squeda -->
    <header class="main-header-section">
        <div class="container">
            <div class="header-top-row">
                <!-- Logo -->
                <div class="logo-section-main">
                    <a href="index.html" class="main-logo-link">
                        <img src="images/logo.png" alt="Tropiplus Supermarket" class="main-logo-image">
                        <span class="main-logo-text">Tropiplus Supermarket</span>
                    </a>
                </div>

                <!-- B√∫squeda y Navegaci√≥n -->
                <div class="header-search-nav">
                    <button class="categories-main-btn">
                        Categor√≠as <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="location-display">
                        <i class="fas fa-map-marker-alt"></i> Real Campi√±a, Aguada de Pasajeros
                    </div>
                    <div class="main-search-wrapper">
                        <input type="text" class="main-search-input" placeholder="Buscar en la tienda ..." id="main-search">
                        <button class="main-search-btn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>

                <!-- Usuario y Carrito -->
                <div class="header-user-section">
                    <div class="user-account-link" id="user-account-link">
                        <i class="fas fa-user"></i>
                        <span id="user-account-text">Mi Cuenta</span>
                    </div>
                    <div class="cart-icon-wrapper" id="cart-trigger">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-badge-number">0</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Barra de Navegaci√≥n Azul Oscuro -->
    <div class="nav-bar-dark-blue">
        <div class="container">
            <div class="nav-bar-inner">
                <button class="menu-hamburger">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="nav-links-main">
                    <a href="admin.html" class="nav-link-item"><i class="fas fa-cog"></i> Admin</a>
                    <a href="index.html" class="nav-link-item"><i class="fas fa-home"></i> Home</a>
                </div>
                <div class="nav-right-items" style="display:none;"></div>
            </div>
        </div>
    </div>

    <!-- Contenido de Administraci√≥n -->
    <div class="admin-container">
        <div class="admin-header">
            <h1>
                <i class="fas fa-cog"></i>
                Panel de Administraci√≥n
            </h1>
            <p style="margin: 10px 0 0 0; opacity: 0.9;">Gesti√≥n de inventario y proveedores</p>
        </div>

        <!-- Navegaci√≥n interna de Admin -->
        <div class="admin-internal-nav" id="admin-internal-nav" style="display: flex; gap: 10px; margin-bottom: 30px; border-bottom: 2px solid var(--gray-border); padding-bottom: 10px;">
            <button class="admin-internal-btn active" data-subtab="inventory">
                <i class="fas fa-boxes"></i> Inventario
            </button>
            <button class="admin-internal-btn" data-subtab="add-product">
                <i class="fas fa-plus-circle"></i> Agregar Producto
            </button>
            <button class="admin-internal-btn" data-subtab="suppliers">
                <i class="fas fa-truck"></i> Proveedores
            </button>
            <button class="admin-internal-btn" data-subtab="promotion">
                <i class="fas fa-bullhorn"></i> Promocion
            </button>
            <button class="admin-internal-btn" data-subtab="qr">
                <i class="fas fa-qrcode"></i> QR
            </button>
            <button class="admin-internal-btn" data-subtab="hours">
                <i class="fas fa-clock"></i> Horario
            </button>
            <button class="admin-internal-btn" data-subtab="tv">
                <i class="fas fa-tv"></i> TV
            </button>
        </div>

        <!-- Contenido de Admin -->
        <div id="admin-content" class="admin-content active">
            <!-- Subtab de Inventario -->
            <div id="inventory-content" class="admin-subcontent active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-card-title">Total Productos</div>
                    <div class="stat-card-value" id="total-products">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-title">Bajo Stock</div>
                    <div class="stat-card-value" id="low-stock-count" style="color: #c62828;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-title">Agotados</div>
                    <div class="stat-card-value" id="out-of-stock-count" style="color: #c2185b;">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-title">Con Proveedor</div>
                    <div class="stat-card-value" id="with-supplier-count">0</div>
                </div>
            </div>

            <div class="search-filter-bar">
                <input type="text" class="search-input" id="product-search" placeholder="Buscar por nombre, SKU, GTIN, precio...">
                <select class="filter-select" id="stock-filter">
                    <option value="all">Todos los productos</option>
                    <option value="low">Bajo stock</option>
                    <option value="out">Agotados</option>
                    <option value="with-supplier">Con proveedor</option>
                    <option value="without-supplier">Sin proveedor</option>
                </select>
            </div>

            <div style="overflow-x: auto;">
                <table class="products-table">
                    <thead>
                        <tr>
                            <th style="width: 80px;">Imagen</th>
                            <th>Producto</th>
                            <th>Stock</th>
                            <th>Proveedor</th>
                            <th>URL Compra</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="products-table-body">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 32px; color: var(--gray-text);"></i>
                                <p style="margin-top: 15px; color: var(--gray-text);">Cargando productos...</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div>

            <!-- Subtab de Agregar Producto -->
            <div id="add-product-content" class="admin-subcontent">
            <div style="margin-bottom: 25px; text-align: center;">
                <h2 style="margin-bottom: 12px; font-size: 24px;">
                    <i class="fas fa-plus-circle"></i> Agregar Nuevo Producto
                </h2>
                <p style="color: var(--gray-text); margin-bottom: 0; font-size: 14px;">
                    Crea un nuevo producto en Square POS con todos sus detalles.
                </p>
            </div>

            <div class="global-supplier-form-container" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin: 0 auto; max-width: 700px;">
                <div style="margin-bottom: 20px; text-align: center;">
                    <button type="button" onclick="openUrlExtractorModal()" style="background: var(--green-categories); color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; display: inline-flex; align-items: center; gap: 8px;">
                        <i class="fas fa-link"></i> Extraer datos desde URL
                    </button>
                    <small style="display: block; margin-top: 8px; color: var(--gray-text); font-size: 12px;">Ingresa una URL de producto para extraer autom√°ticamente nombre, descripci√≥n, foto y SKU</small>
                </div>
                
                <form id="add-product-form">
                    <div class="supplier-form-group">
                        <label for="product-name">Nombre del Producto *</label>
                        <input type="text" id="product-name" required placeholder="Ej: Arroz Integral">
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-description">Descripci√≥n</label>
                        <textarea id="product-description" rows="3" placeholder="Descripci√≥n detallada del producto"></textarea>
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-sku">SKU</label>
                        <input type="text" id="product-sku" placeholder="C√≥digo SKU √∫nico">
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-gtin">GTIN (UPC, EAN o ISBN)</label>
                        <input type="text" id="product-gtin" placeholder="UPC, EAN or ISBN">
                        <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                            <button type="button" id="lookup-barcode-btn" style="background: #1976d2; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                <i class="fas fa-barcode"></i> Buscar codigo automaticamente
                            </button>
                            <small id="barcode-lookup-status" style="color: var(--gray-text); display: inline-flex; align-items: center; font-size: 12px;"></small>
                        </div>
                        <small style="color: var(--gray-text); display: block; margin-top: 5px; font-size: 12px;">Codigo de barras del producto (se usara en Square POS para escaner)</small>
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-price">Precio (USD) *</label>
                        <input type="number" id="product-price" step="0.01" min="0" required placeholder="0.00">
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-quantity">Cantidad Inicial en Inventario</label>
                        <input type="number" id="product-quantity" min="0" value="0" placeholder="0">
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-category">Categor√≠a *</label>
                        <select id="product-category" required style="width: 100%; padding: 10px; border: 2px solid var(--gray-border); border-radius: 6px; font-size: 14px; background: white; cursor: pointer;">
                            <option value="">Seleccionar categor√≠a...</option>
                        </select>
                    </div>

                    <div class="supplier-form-group">
                        <label for="product-location">Location *</label>
                        <select id="product-location" required style="width: 100%; padding: 10px; border: 2px solid var(--gray-border); border-radius: 6px; font-size: 14px; background: white; cursor: pointer;">
                            <option value="">Cargando locations...</option>
                        </select>
                        <small style="color: var(--gray-text); display: block; margin-top: 5px; font-size: 12px;">
                            Por defecto se selecciona TropiPlus Supermarket.
                        </small>
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="product-image">Imagen del Producto</label>
                        <input type="file" id="product-image" accept="image/*" style="width: 100%; padding: 10px; border: 2px solid var(--gray-border); border-radius: 6px; font-size: 14px;">
                        <small style="color: var(--gray-text); display: block; margin-top: 5px; font-size: 12px;">Selecciona una imagen para el producto</small>
                        <div id="product-image-preview" style="margin-top: 10px; display: none;">
                            <img id="product-image-preview-img" src="" alt="Vista previa" style="max-width: 200px; max-height: 200px; border-radius: 6px; border: 2px solid var(--gray-border);">
                        </div>
                    </div>
                    
                    <div class="supplier-modal-footer">
                        <button type="button" class="btn-cancel" onclick="document.getElementById('add-product-form').reset(); document.getElementById('product-image-preview').style.display='none';">Limpiar</button>
                        <button type="submit" class="btn-save">
                            <i class="fas fa-save"></i> Guardar Producto
                        </button>
                    </div>
                </form>
            </div>
            </div>

            <!-- Subtab de Proveedores -->
            <div id="suppliers-content" class="admin-subcontent">
            <div style="margin-bottom: 25px; text-align: center;">
                <h2 style="margin-bottom: 12px; font-size: 24px;">
                    <i class="fas fa-truck"></i> Gesti√≥n de Proveedores
                </h2>
                <p style="color: var(--gray-text); margin-bottom: 0; font-size: 14px;">
                    Agrega proveedores globales que podr√°s reutilizar al asignar proveedores a productos.
                </p>
            </div>

            <div class="global-supplier-form-container" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin: 0 auto 25px auto;">
                <h3 style="margin-bottom: 18px; font-size: 18px; text-align: center;">Agregar Nuevo Proveedor</h3>
                <form id="global-supplier-form">
                    <div class="supplier-form-group">
                        <label for="global-supplier-name">Nombre del Proveedor *</label>
                        <input type="text" id="global-supplier-name" required>
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="global-supplier-address">Direcci√≥n</label>
                        <input type="text" id="global-supplier-address">
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="global-supplier-url">URL del Proveedor</label>
                        <input type="url" id="global-supplier-url" placeholder="https://...">
                    </div>
                    
                    <div class="supplier-form-group">
                        <label for="global-supplier-notes">Notas</label>
                        <textarea id="global-supplier-notes" rows="3"></textarea>
                    </div>
                    
                    <div class="supplier-modal-footer">
                        <button type="button" class="btn-cancel" onclick="if (typeof cancelEditGlobalSupplier === 'function') cancelEditGlobalSupplier(); document.getElementById('global-supplier-form').reset();">Limpiar</button>
                        <button type="submit" class="btn-save">Guardar Proveedor</button>
                    </div>
                </form>
            </div>

            <div class="global-suppliers-list-container" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="margin-bottom: 18px; font-size: 18px; text-align: center;">Proveedores Guardados</h3>
                <div id="global-suppliers-list">
                    <p style="text-align: center; padding: 40px; color: var(--gray-text);">
                        <i class="fas fa-spinner fa-spin" style="font-size: 32px; margin-bottom: 15px; display: block;"></i>
                        Cargando proveedores...
                    </p>
                </div>
            </div>
            </div>

            <!-- Subtab de Promoci√≥n -->
            <div id="promotion-content" class="admin-subcontent">
            <div style="margin-bottom: 25px; text-align: center;">
                <h2 style="margin-bottom: 12px; font-size: 24px;">
                    <i class="fas fa-bullhorn"></i> Texto de Promoci√≥n
                </h2>
                <p style="color: var(--gray-text); margin-bottom: 0; font-size: 14px;">
                    Configura el texto que se muestra de derecha a izquierda en la barra promocional de la web.
                </p>
            </div>

            <div class="global-supplier-form-container" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin: 0 auto; max-width: 760px;">
                <form id="promotion-form">
                    <div class="supplier-form-group">
                        <label for="promo-enabled">Activar barra de promoci√≥n</label>
                        <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                            <input type="checkbox" id="promo-enabled" style="width:auto; transform:scale(1.1);">
                            <span>Mostrar texto promocional en la web</span>
                        </label>
                    </div>

                    <div class="supplier-form-group">
                        <label for="promo-text">Texto de promoci√≥n *</label>
                        <textarea id="promo-text" rows="3" maxlength="280" placeholder="Ej: Aprovecha hoy: 10% de descuento en productos seleccionados."></textarea>
                        <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                            Este texto se desplazar√° de derecha a izquierda.
                        </small>
                    </div>

                    <div class="supplier-form-group">
                        <label for="promo-speed">Velocidad de desplazamiento</label>
                        <select id="promo-speed">
                            <option value="slow">Lenta</option>
                            <option value="normal" selected>Normal</option>
                            <option value="fast">R√°pida</option>
                        </select>
                    </div>

                    <div class="supplier-form-group">
                        <label for="promo-font-size">Tama√±o del texto</label>
                        <select id="promo-font-size">
                            <option value="12px">Peque√±o (12px)</option>
                            <option value="14px" selected>Mediano (14px)</option>
                            <option value="16px">Grande (16px)</option>
                            <option value="18px">Muy Grande (18px)</option>
                            <option value="20px">Extra Grande (20px)</option>
                        </select>
                    </div>

                    <div class="supplier-form-group">
                        <label for="promo-text-color">Color del texto</label>
                        <input type="color" id="promo-text-color" value="#ffffff" style="width: 100%; height: 40px; border-radius: 4px; border: 1px solid #dfe4f4;">
                    </div>

                    <div class="supplier-form-group">
                        <label for="promo-bg-color">Color de fondo</label>
                        <input type="color" id="promo-bg-color" value="#1f318a" style="width: 100%; height: 40px; border-radius: 4px; border: 1px solid #dfe4f4;">
                    </div>

                    <div class="supplier-form-group">
                        <label for="promo-link-enabled">Habilitar enlace al tocar el texto</label>
                        <label style="display:flex; align-items:center; gap:10px; cursor:pointer;">
                            <input type="checkbox" id="promo-link-enabled" style="width:auto; transform:scale(1.1);">
                            <span>Activar redirecci√≥n por URL</span>
                        </label>
                    </div>

                    <div class="supplier-form-group" id="promo-url-group" style="display:none;">
                        <label for="promo-url">URL de destino</label>
                        <input type="url" id="promo-url" placeholder="https://...">
                        <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                            Solo se usar√° si el enlace est√° activado.
                        </small>
                    </div>

                    <div class="supplier-form-group">
                        <label>Vista previa</label>
                        <div id="promo-preview-box" style="background:#13348f; border-radius:8px; overflow:hidden; border:1px solid #dfe4f4;">
                            <div id="promo-preview-track" style="white-space:nowrap; padding:10px 0; color:white; font-weight:600;">
                                <span id="promo-preview-text" style="display:inline-block; padding-left:100%;">Sin texto de promoci√≥n...</span>
                            </div>
                        </div>
                    </div>

                    <div class="supplier-modal-footer">
                        <button type="button" class="btn-cancel" id="promo-reset-btn">Restablecer</button>
                        <button type="submit" class="btn-save">
                            <i class="fas fa-save"></i> Guardar Promoci√≥n
                        </button>
                    </div>
                </form>
            </div>
            </div>

            <!-- Subtab de QR -->
            <div id="qr-content" class="admin-subcontent">
                <div style="margin-bottom: 25px; text-align: center;">
                    <h2 style="margin-bottom: 12px; font-size: 24px;">
                        <i class="fas fa-qrcode"></i> Configuraci√≥n de C√≥digos QR
                    </h2>
                    <p style="color: var(--gray-text); margin-bottom: 0; font-size: 14px;">
                        Crea y configura c√≥digos QR que se pueden mostrar en los TVs.
                    </p>
                </div>

                <div style="max-width: 600px; margin: 0 auto;">
                    <form id="qr-config-form" style="background: white; padding: 24px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div class="supplier-form-group">
                            <label for="qr-name">Nombre del QR *</label>
                            <input type="text" id="qr-name" placeholder="Ej: QR Men√∫, QR Pedidos" required>
                        </div>

                        <div class="supplier-form-group">
                            <label for="qr-url">URL *</label>
                            <input type="url" id="qr-url" placeholder="https://..." required>
                            <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                                URL que se codificar√° en el c√≥digo QR.
                            </small>
                        </div>

                        <div class="supplier-form-group">
                            <label for="qr-size">Tama√±o del QR (p√≠xeles)</label>
                            <select id="qr-size">
                                <option value="200">200px (Peque√±o)</option>
                                <option value="300" selected>300px (Mediano)</option>
                                <option value="400">400px (Grande)</option>
                                <option value="500">500px (Extra Grande)</option>
                            </select>
                        </div>

                        <div class="supplier-form-group">
                            <label style="display:flex; align-items:center; gap:10px;">
                                <input type="checkbox" id="qr-active" checked style="width:auto;">
                                QR Activo
                            </label>
                        </div>

                        <div style="display: flex; gap: 12px; margin-top: 24px;">
                            <button type="button" id="qr-reset-btn" class="btn-secondary" style="flex: 1;">
                                Limpiar
                            </button>
                            <button type="submit" class="btn-primary" style="flex: 1;">
                                <i class="fas fa-save"></i> Guardar QR
                            </button>
                        </div>
                    </form>

                    <div style="margin-top: 30px;">
                        <h3 style="margin-bottom: 16px; font-size: 18px;">QRs Configurados</h3>
                        <div id="qr-list" style="background: white; padding: 16px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <p style="color: var(--gray-text); text-align: center; padding: 20px;">
                                No hay QRs configurados a√∫n.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Subtab de Horario -->
            <div id="hours-content" class="admin-subcontent">
                <div style="margin-bottom: 25px; text-align: center;">
                    <h2 style="margin-bottom: 12px; font-size: 24px;">
                        <i class="fas fa-clock"></i> Horarios de Trabajo
                    </h2>
                    <p style="color: var(--gray-text); margin-bottom: 0; font-size: 14px;">
                        Configura los d√≠as y horarios de trabajo de la tienda. Los TVs mostrar√°n "CERRADO" cuando est√© fuera del horario configurado.
                    </p>
                </div>

                <div style="max-width: 800px; margin: 0 auto;">
                    <form id="hours-config-form" style="background: white; padding: 24px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div id="hours-days-container">
                            <!-- Los d√≠as se generar√°n din√°micamente -->
                        </div>

                        <div style="display: flex; gap: 12px; margin-top: 24px;">
                            <button type="button" id="hours-reset-btn" class="btn-secondary" style="flex: 1;">
                                Limpiar
                            </button>
                            <button type="submit" class="btn-primary" style="flex: 1;">
                                <i class="fas fa-save"></i> Guardar Horarios
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Subtab de TV -->
            <div id="tv-content" class="admin-subcontent">
                <div style="margin-bottom: 22px; text-align: center;">
                    <h2 style="margin-bottom: 8px; font-size: 24px;">
                        <i class="fas fa-tv"></i> Gestor de TVs
                    </h2>
                    <p style="color: var(--gray-text); margin-bottom: 0; font-size: 14px;">
                        Crea TVs por nombre y define qu√© mostrar√° cada una: productos, ofertas y texto promocional.
                    </p>
                </div>

                <div class="tv-admin-grid">
                    <div class="tv-panel-card">
                        <h3 style="margin-top: 0;">Configurar TV</h3>
                        <form id="tv-config-form">
                            <input type="hidden" id="tv-id">

                            <div class="supplier-form-group">
                                <label for="tv-name">Nombre del TV *</label>
                                <input type="text" id="tv-name" placeholder="Ej: TV Entrada, TV Caja 1" required>
                            </div>

                            <div class="supplier-form-group">
                                <label for="tv-mode">Modo de contenido</label>
                                <select id="tv-mode">
                                    <option value="mixed">Mixto (Productos + Promo)</option>
                                    <option value="products">Solo Productos</option>
                                    <option value="promo">Solo Promoci√≥n</option>
                                    <option value="orders">Listado de Pedidos</option>
                                    <option value="qr">C√≥digo QR</option>
                                </select>
                            </div>
                            
                            <div class="supplier-form-group" id="tv-qr-select-group" style="display:none;">
                                <label for="tv-qr-select">Seleccionar QR configurado *</label>
                                <select id="tv-qr-select" style="width: 100%; padding: 10px; border: 2px solid var(--gray-border); border-radius: 6px; font-size: 14px; background: white; cursor: pointer;">
                                    <option value="">Seleccionar QR...</option>
                                </select>
                                <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                                    Selecciona un QR de la pesta√±a "QR" o crea uno nuevo.
                                </small>
                            </div>

                            <div class="supplier-form-group" id="tv-category-group">
                                <label for="tv-category">Categor√≠a de productos</label>
                                <select id="tv-category">
                                    <option value="">Todas las categor√≠as</option>
                                </select>
                            </div>

                            <div class="supplier-form-group" id="tv-product-count-group">
                                <label for="tv-product-count">Cantidad de productos a rotar</label>
                                <input type="number" id="tv-product-count" min="1" max="50" value="8">
                            </div>

                            <div class="supplier-form-group" id="tv-slide-seconds-group">
                                <label for="tv-slide-seconds">Segundos por producto</label>
                                <input type="number" id="tv-slide-seconds" min="3" max="60" value="10">
                            </div>

                            <div class="supplier-form-group" id="tv-mixed-transition-seconds-group" style="display:none;">
                                <label for="tv-mixed-transition-seconds">Segundos por secci√≥n (modo mixto)</label>
                                <input type="number" id="tv-mixed-transition-seconds" min="5" max="120" value="12">
                                <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                                    Tiempo para pasar de una secci√≥n a la siguiente (Productos, Pedidos, QR, Promoci√≥n).
                                </small>
                            </div>

                            <div class="supplier-form-group" id="tv-show-price-group">
                                <label style="display:flex; align-items:center; gap:10px;">
                                    <input type="checkbox" id="tv-show-price" checked style="width:auto;">
                                    Mostrar precio en pantalla
                                </label>
                            </div>

                            <div class="supplier-form-group" id="tv-show-offer-group">
                                <label style="display:flex; align-items:center; gap:10px;">
                                    <input type="checkbox" id="tv-show-offer" checked style="width:auto;">
                                    Mostrar etiqueta OFERTA
                                </label>
                            </div>

                            <div class="supplier-form-group" id="tv-promo-text-group">
                                <label for="tv-promo-text">Texto promocional para este TV (opcional)</label>
                                <textarea id="tv-promo-text" rows="2" placeholder="Si lo dejas vac√≠o usa la promoci√≥n global."></textarea>
                            </div>

                            <div class="supplier-form-group" id="tv-ticker-enabled-group">
                                <label style="display:flex; align-items:center; gap:10px;">
                                    <input type="checkbox" id="tv-ticker-enabled" checked style="width:auto;">
                                    Activar texto promocional en TV
                                </label>
                                <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                                    Muestra el texto promocional en la parte inferior del TV.
                                </small>
                            </div>

                            <div class="supplier-form-group" id="tv-ticker-speed-group">
                                <label for="tv-ticker-speed">Velocidad del texto promocional</label>
                                <select id="tv-ticker-speed">
                                    <option value="slow">Lenta</option>
                                    <option value="normal" selected>Normal</option>
                                    <option value="fast">R√°pida</option>
                                </select>
                                <small style="color: var(--gray-text); display:block; margin-top:6px; font-size:12px;">
                                    Velocidad del texto que se desplaza en la parte inferior del TV.
                                </small>
                            </div>

                            <div class="supplier-form-group" id="tv-ticker-font-size-group">
                                <label for="tv-ticker-font-size">Tama√±o del texto promocional</label>
                                <select id="tv-ticker-font-size">
                                    <option value="20px">Peque√±o (20px)</option>
                                    <option value="24px">Mediano (24px)</option>
                                    <option value="28px" selected>Grande (28px)</option>
                                    <option value="32px">Muy Grande (32px)</option>
                                    <option value="36px">Extra Grande (36px)</option>
                                </select>
                            </div>

                            <div class="supplier-form-group" id="tv-ticker-text-color-group">
                                <label for="tv-ticker-text-color">Color del texto promocional</label>
                                <input type="color" id="tv-ticker-text-color" value="#ffec67" style="width: 100%; height: 40px; border-radius: 4px; border: 1px solid #dfe4f4;">
                            </div>

                            <div class="supplier-form-group" id="tv-ticker-bg-color-group">
                                <label for="tv-ticker-bg-color">Color de fondo del texto promocional</label>
                                <input type="color" id="tv-ticker-bg-color" value="#000000" style="width: 100%; height: 40px; border-radius: 4px; border: 1px solid #dfe4f4;">
                            </div>

                            <div class="supplier-form-group">
                                <label style="display:flex; align-items:center; gap:10px;">
                                    <input type="checkbox" id="tv-active" checked style="width:auto;">
                                    TV activo
                                </label>
                            </div>

                            <div class="supplier-modal-footer">
                                <button type="button" class="btn-cancel" id="tv-reset-btn">Limpiar</button>
                                <button type="submit" class="btn-save">
                                    <i class="fas fa-save"></i> Guardar TV
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="tv-panel-card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <h3 style="margin: 0;">TVs Registrados</h3>
                            <a href="tv-selector.html" target="_blank" class="btn-primary" style="background: #1a73e8; color: white; padding: 8px 16px; border-radius: 4px; text-decoration: none; display: inline-flex; align-items: center; gap: 8px;">
                                <i class="fas fa-tv"></i> Abrir P√°gina de TV
                            </a>
                        </div>
                        <div id="tv-list-container">
                            <p style="color: var(--gray-text);">No hay TVs configurados.</p>
                        </div>
                        <hr style="margin: 16px 0;">
                        <div style="background: #f0f7ff; border-left: 4px solid #42b649; padding: 12px; border-radius: 4px; margin-bottom: 12px;">
                            <h4 style="margin: 0 0 8px 0; font-size: 14px; color: #1f318a;">
                                <i class="fas fa-lightbulb"></i> Gu√≠a de Configuraci√≥n Profesional
                            </h4>
                            <div style="font-size: 12px; color: #333; line-height: 1.6;">
                                <p style="margin: 0 0 8px 0;"><strong>üì∫ TV Entrada/Recepci√≥n:</strong></p>
                                <ul style="margin: 0 0 12px 0; padding-left: 20px;">
                                    <li>Modo: <strong>Mixto</strong> (Productos + Promo)</li>
                                    <li>Categor√≠a: <strong>Todas</strong></li>
                                    <li>Productos: <strong>12-15</strong></li>
                                    <li>Segundos: <strong>8-10</strong></li>
                                    <li>‚úì Precio ‚úì Oferta</li>
                                    <li>Texto: "Bienvenido a Tropiplus - Ofertas del d√≠a"</li>
                                </ul>
                                
                                <p style="margin: 0 0 8px 0;"><strong>üõí TV Pasillo/Categor√≠a Espec√≠fica:</strong></p>
                                <ul style="margin: 0 0 12px 0; padding-left: 20px;">
                                    <li>Modo: <strong>Solo Productos</strong></li>
                                    <li>Categor√≠a: <strong>Seleccionar categor√≠a</strong> (ej: Carnes, Lacteos)</li>
                                    <li>Productos: <strong>6-8</strong></li>
                                    <li>Segundos: <strong>12-15</strong> (m√°s tiempo para leer)</li>
                                    <li>‚úì Precio ‚úì Oferta</li>
                                    <li>Texto: Dejar vac√≠o o espec√≠fico de la categor√≠a</li>
                                </ul>
                                
                                <p style="margin: 0 0 8px 0;"><strong>üí∞ TV Caja/Pago:</strong></p>
                                <ul style="margin: 0 0 12px 0; padding-left: 20px;">
                                    <li>Modo: <strong>Mixto</strong></li>
                                    <li>Categor√≠a: <strong>Ofertas destacadas</strong> o "Todas"</li>
                                    <li>Productos: <strong>10</strong></li>
                                    <li>Segundos: <strong>6-8</strong> (m√°s din√°mico)</li>
                                    <li>‚úì Precio ‚úì Oferta</li>
                                    <li>Texto: "Aprovecha nuestras ofertas especiales"</li>
                                </ul>
                                
                                <p style="margin: 0 0 8px 0;"><strong>üì¢ TV Solo Promoci√≥n:</strong></p>
                                <ul style="margin: 0; padding-left: 20px;">
                                    <li>Modo: <strong>Solo Promoci√≥n</strong></li>
                                    <li>Texto: Mensaje promocional largo y detallado</li>
                                    <li>Ideal para: Anuncios de eventos, descuentos generales</li>
                                </ul>
                            </div>
                        </div>
                        <p style="font-size: 13px; color: var(--gray-text); margin: 0;">
                            <strong>Consejo:</strong> Abre `tv.html?tv=ID_DEL_TV` en cada televisor/box y d√©jalo en pantalla completa (F11).
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Extracci√≥n de URL -->
    <div class="supplier-modal" id="url-extractor-modal">
        <div class="supplier-modal-content">
            <h2 style="margin-top: 0; margin-bottom: 18px; font-size: 20px;">
                <i class="fas fa-link"></i> Extraer Datos desde URL
            </h2>
            <form id="url-extractor-form">
                <div class="supplier-form-group">
                    <label for="product-url">URL del Producto *</label>
                    <input type="url" id="product-url" required placeholder="https://ejemplo.com/producto" style="width: 100%; padding: 10px; border: 2px solid var(--gray-border); border-radius: 6px; font-size: 14px;">
                    <small style="color: var(--gray-text); display: block; margin-top: 5px; font-size: 12px;">Ingresa la URL completa del producto</small>
                </div>
                
                <div id="url-extractor-status" style="margin: 15px 0; padding: 10px; border-radius: 6px; display: none;">
                    <i class="fas fa-spinner fa-spin"></i> <span id="url-extractor-status-text">Extrayendo datos...</span>
                </div>
                
                <div class="supplier-modal-footer">
                    <button type="button" class="btn-cancel" onclick="closeUrlExtractorModal()">Cancelar</button>
                    <button type="submit" class="btn-save">
                        <i class="fas fa-magic"></i> Extraer Datos
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Proveedor -->
    <div class="supplier-modal" id="supplier-modal">
        <div class="supplier-modal-content">
            <h2 style="margin-top: 0; margin-bottom: 18px; font-size: 20px;">
                <i class="fas fa-truck"></i> Informaci√≥n del Proveedor
            </h2>
            <form id="supplier-form">
                <input type="hidden" id="supplier-product-id">
                <input type="hidden" id="supplier-variation-id">
                
                <div class="supplier-form-group">
                    <label for="supplier-global-select">Seleccionar proveedor guardado (opcional)</label>
                    <select id="supplier-global-select" style="width: 100%; padding: 10px; border: 2px solid var(--gray-border); border-radius: 6px; font-size: 14px; background: white; cursor: pointer; margin-bottom: 8px;">
                        <option value="">Seleccionar proveedor guardado...</option>
                    </select>
                    <small style="color: var(--gray-text); display: block; margin-top: 5px; font-size: 12px;">O completa los campos manualmente</small>
                </div>
                
                <div class="supplier-form-group">
                    <label for="supplier-name">Nombre del Proveedor *</label>
                    <input type="text" id="supplier-name" required>
                </div>
                
                <div class="supplier-form-group">
                    <label for="supplier-address">Direcci√≥n</label>
                    <input type="text" id="supplier-address">
                </div>
                
                <div class="supplier-form-group">
                    <label for="supplier-url">URL del Proveedor</label>
                    <input type="url" id="supplier-url" placeholder="https://...">
                </div>
                
                <div class="supplier-form-group">
                    <label for="supplier-purchase-url">URL de Compra del Producto</label>
                    <input type="url" id="supplier-purchase-url" placeholder="https://...">
                </div>
                
                <div class="supplier-form-group">
                    <label for="supplier-notes">Notas</label>
                    <textarea id="supplier-notes" rows="3"></textarea>
                </div>
                
                <div class="supplier-modal-footer">
                    <button type="button" class="btn-cancel" id="supplier-cancel-btn">Cancelar</button>
                    <button type="submit" class="btn-save">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/square-config.js"></script>
    <script src="js/square-integration.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
    <script src="js/modal.js"></script>
    <script src="js/supabase-config.js?v=20260210o"></script>
    <script src="js/admin.js?v=20260210o"></script>
</body>
</html>
